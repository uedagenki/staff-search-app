<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¦ãƒ¼ã‚¶ãƒ¼æ–°è¦ç™»éŒ² - STAFF SEARCH</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .register-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .register-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .register-header h1 {
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: 700;
        }

        .register-header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .register-body {
            padding: 30px;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 14px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .category-selection {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 8px;
        }

        .category-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-item input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }

        .category-item:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .category-item input[type="checkbox"]:checked + label {
            font-weight: bold;
            color: #667eea;
        }

        .register-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .register-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .login-link {
            margin-top: 20px;
            text-align: center;
            font-size: 14px;
        }

        .login-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }

        .login-link a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .category-selection {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="register-container">
        <div class="register-header">
            <h1>ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ–°è¦ç™»éŒ²</h1>
            <p>ã‚ãªãŸã«ã´ã£ãŸã‚Šã®ã‚¹ã‚¿ãƒƒãƒ•ã‚’è¦‹ã¤ã‘ã‚ˆã†</p>
        </div>

        <div class="register-body">
            <form id="userRegisterForm">
                <div class="form-group">
                    <label for="name">ãŠåå‰ <span style="color: red;">*</span></label>
                    <input 
                        type="text" 
                        id="name" 
                        name="name" 
                        placeholder="å±±ç”° å¤ªéƒ" 
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="age">å¹´é½¢ <span style="color: red;">*</span></label>
                    <input 
                        type="number" 
                        id="age" 
                        name="age" 
                        placeholder="25" 
                        min="18"
                        max="100"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="address">ä½æ‰€ <span style="color: red;">*</span></label>
                    <div style="display: flex; gap: 10px;">
                        <input 
                            type="text" 
                            id="address" 
                            name="address" 
                            placeholder="æ±äº¬éƒ½æ¸‹è°·åŒº" 
                            required
                            style="flex: 1;"
                        >
                        <button 
                            type="button" 
                            id="getLocationBtn"
                            style="padding: 10px 15px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; white-space: nowrap; font-size: 14px;"
                            title="ç¾åœ¨åœ°ã®ä½æ‰€ã‚’å–å¾—"
                        >
                            ğŸ“ ç¾åœ¨åœ°å–å¾—
                        </button>
                    </div>
                    <div id="locationStatus" style="font-size: 12px; margin-top: 5px; color: #666;"></div>
                </div>

                <div class="form-group">
                    <label for="gender">æ€§åˆ¥ <span style="color: red;">*</span></label>
                    <select id="gender" name="gender" required>
                        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                        <option value="male">ç”·æ€§</option>
                        <option value="female">å¥³æ€§</option>
                        <option value="other">ãã®ä»–</option>
                        <option value="no-answer">å›ç­”ã—ãªã„</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ã©ã‚“ãªã‚¹ã‚¿ãƒƒãƒ•ã‚’æ¢ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ <span style="color: red;">*</span></label>
                    <p style="font-size: 12px; color: #666; margin-bottom: 8px;">3ã¤ã¾ã§é¸æŠå¯èƒ½</p>
                    <div class="category-selection">
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="beauty">
                            <span>ç¾å®¹ãƒ»å¥åº·</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="consultant">
                            <span>å–¶æ¥­ãƒ»ã‚³ãƒ³ã‚µãƒ«</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="professional">
                            <span>å°‚é–€è·ãƒ»å£«æ¥­</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="creative">
                            <span>ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="tech">
                            <span>ITãƒ»æŠ€è¡“</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="education">
                            <span>æ•™è‚²ãƒ»æŒ‡å°</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="care">
                            <span>åŒ»ç™‚ãƒ»ä»‹è­·</span>
                        </label>
                        <label class="category-item">
                            <input type="checkbox" name="categories" value="other">
                            <span>ãã®ä»–</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span style="color: red;">*</span></label>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        placeholder="example@email.com" 
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ <span style="color: red;">*</span></label>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        placeholder="8æ–‡å­—ä»¥ä¸Š" 
                        minlength="8"
                        required
                    >
                </div>

                <!-- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ãƒ»åˆ©ç”¨è¦ç´„ åŒæ„ -->
                <div class="form-group" style="margin-top: 20px;">
                    <label style="display: flex; align-items: flex-start; cursor: pointer;">
                        <input 
                            type="checkbox" 
                            id="agreeTerms" 
                            name="agreeTerms"
                            required
                            style="margin-right: 10px; margin-top: 3px; cursor: pointer;"
                        >
                        <span style="font-size: 13px; line-height: 1.6;">
                            <a href="privacy_policy.html" target="_blank" style="color: #667eea; text-decoration: underline;">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
                            ãŠã‚ˆã³
                            <a href="terms_of_service.html" target="_blank" style="color: #667eea; text-decoration: underline;">åˆ©ç”¨è¦ç´„</a>
                            ã«åŒæ„ã—ã¾ã™ <span style="color: red;">*</span>
                        </span>
                    </label>
                </div>

                <button type="submit" class="register-button">ç™»éŒ²ã™ã‚‹</button>

                <div class="login-link">
                    ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã®æ–¹ã¯ <a href="user_login.html">ãƒ­ã‚°ã‚¤ãƒ³</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠã®åˆ¶é™ï¼ˆæœ€å¤§3ã¤ï¼‰
        const checkboxes = document.querySelectorAll('input[name="categories"]');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const checkedCount = document.querySelectorAll('input[name="categories"]:checked').length;
                if (checkedCount > 3) {
                    this.checked = false;
                    alert('ã‚«ãƒ†ã‚´ãƒªãƒ¼ã¯æœ€å¤§3ã¤ã¾ã§é¸æŠã§ãã¾ã™');
                }
            });
        });

        // ä½ç½®æƒ…å ±å–å¾—æ©Ÿèƒ½
        document.getElementById('getLocationBtn').addEventListener('click', async function() {
            const statusDiv = document.getElementById('locationStatus');
            const addressInput = document.getElementById('address');
            const btn = this;
            
            // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            btn.disabled = true;
            btn.textContent = 'å–å¾—ä¸­...';
            statusDiv.textContent = 'ä½ç½®æƒ…å ±ã‚’å–å¾—ã—ã¦ã„ã¾ã™...';
            statusDiv.style.color = '#667eea';
            
            if (!navigator.geolocation) {
                statusDiv.textContent = 'ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä½ç½®æƒ…å ±ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“';
                statusDiv.style.color = 'red';
                btn.disabled = false;
                btn.textContent = 'ğŸ“ ç¾åœ¨åœ°å–å¾—';
                return;
            }
            
            navigator.geolocation.getCurrentPosition(
                async function(position) {
                    const lat = position.coords.latitude;
                    const lon = position.coords.longitude;
                    
                    try {
                        // OpenStreetMap Nominatim APIã‚’ä½¿ç”¨ï¼ˆç„¡æ–™ãƒ»ç™»éŒ²ä¸è¦ï¼‰
                        const response = await fetch(
                            `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=10&addressdetails=1&accept-language=ja`,
                            {
                                headers: {
                                    'User-Agent': 'StaffSearchApp/1.0'
                                }
                            }
                        );
                        
                        if (!response.ok) {
                            throw new Error('ä½æ‰€ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
                        }
                        
                        const data = await response.json();
                        
                        // ä½æ‰€æƒ…å ±ã‚’æŠ½å‡ºï¼ˆçœŒãƒ»å¸‚ãƒ»ç”ºã¾ã§ï¼‰
                        const address = data.address;
                        let formattedAddress = '';
                        
                        // éƒ½é“åºœçœŒ
                        if (address.state) {
                            formattedAddress += address.state;
                        } else if (address.province) {
                            formattedAddress += address.province;
                        }
                        
                        // å¸‚åŒºç”ºæ‘
                        if (address.city) {
                            formattedAddress += address.city;
                        } else if (address.town) {
                            formattedAddress += address.town;
                        } else if (address.village) {
                            formattedAddress += address.village;
                        } else if (address.county) {
                            formattedAddress += address.county;
                        }
                        
                        // ç”ºåŸŸ
                        if (address.suburb) {
                            formattedAddress += address.suburb;
                        } else if (address.neighbourhood) {
                            formattedAddress += address.neighbourhood;
                        }
                        
                        if (formattedAddress) {
                            addressInput.value = formattedAddress;
                            statusDiv.textContent = 'âœ“ ä½æ‰€ã‚’å–å¾—ã—ã¾ã—ãŸ';
                            statusDiv.style.color = 'green';
                        } else {
                            statusDiv.textContent = 'ä½æ‰€æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚æ‰‹å‹•ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                            statusDiv.style.color = 'orange';
                        }
                        
                    } catch (error) {
                        console.error('Geocoding error:', error);
                        statusDiv.textContent = 'ä½æ‰€ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                        statusDiv.style.color = 'orange';
                    }
                    
                    btn.disabled = false;
                    btn.textContent = 'ğŸ“ ç¾åœ¨åœ°å–å¾—';
                },
                function(error) {
                    let errorMsg = '';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMsg = 'ä½ç½®æƒ…å ±ã®ä½¿ç”¨ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMsg = 'ä½ç½®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ';
                            break;
                        case error.TIMEOUT:
                            errorMsg = 'ä½ç½®æƒ…å ±ã®å–å¾—ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ';
                            break;
                        default:
                            errorMsg = 'ä½ç½®æƒ…å ±ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ';
                    }
                    statusDiv.textContent = errorMsg + 'ã€‚æ‰‹å‹•ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                    statusDiv.style.color = 'orange';
                    btn.disabled = false;
                    btn.textContent = 'ğŸ“ ç¾åœ¨åœ°å–å¾—';
                }
            );
        });

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
        document.getElementById('userRegisterForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const age = document.getElementById('age').value;
            const address = document.getElementById('address').value;
            const gender = document.getElementById('gender').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            const selectedCategories = Array.from(document.querySelectorAll('input[name="categories"]:checked'))
                .map(cb => cb.value);
            
            if (selectedCategories.length === 0) {
                alert('å°‘ãªãã¨ã‚‚1ã¤ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’é¸æŠã—ã¦ãã ã•ã„');
                return;
            }

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            const userData = {
                name: name,
                age: age,
                address: address,
                gender: gender,
                email: email,
                categories: selectedCategories,
                registeredAt: new Date().toISOString(),
                profileImage: null, // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ç”»åƒãªã—
                phone: null
            };
            
            localStorage.setItem('user_profile', JSON.stringify(userData));
            localStorage.setItem('user_logged_in', 'true');
            
            // ç™»éŒ²æˆåŠŸï¼ˆãƒ‡ãƒ¢ï¼‰
            alert(`ç™»éŒ²å®Œäº†ï¼\nã‚ˆã†ã“ã ${name} ã•ã‚“`);
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒ—ãƒªã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
            window.location.href = 'https://5060-ivmmk44rjvkdnze0ep01h-5185f4aa.sandbox.novita.ai/';
        });
    </script>
</body>
</html>
